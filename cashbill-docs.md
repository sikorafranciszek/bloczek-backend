Payment Gateway APIIntroduction
Version: 1.0.0

CashBill Payments API

To use REST API payment point should be configured as “Web Service”.

REST service is available at:

  https://pay.cashbill.pl/ws/rest/

Testing can be performed using:

  https://pay.cashbill.pl/testws/rest/

On every successful request service returns application/json with HTTP 200. In case of error, reply consists of HTTP status code with details in response body.

Digital Signature (Authentication)
Digital signature can be generated by concatenation of request data with secret key, obtainable in CashBill Control Panel.

Used crypto hash function is SHA1, with result presented as hexadecimal lowercase string.

Error Response
Every error response returns application/json with http status of error. JSON response contains errorMessage key with more informations about error reason.

ex.


  # HTTP 401 Unauthorized
  {
    "errorMessage" : "Illegal signature"
  }



  # HTTP 400 Bad Request
  {
    "errorMessage" : "sign is required field"
  }


Notification Service
If payment point is configured as Web Service, CashBill Online Payments will communicate with shop using notification service. URL for notification service must be configured in CashBill Control Panel. Notification service can use HTTP or HTTPS protocol. Notification request consist no sensitive data, and consists of:

name of notification
attribute of notification
digital signature
Each notification is sent as GET request with following variables:

Variable	Description
cmd	name of notification
args	comma (“,”) separated attributes (for ex. orderId)
sign	digital signature
Digital Signature

  sign = md5(cmd + args + secretKey)


MD5 is crypto hash function, with result presented as hexadecimal lowercase string.

Available Notification Requests
Name of request	Description
transactionStatusChanged	Status of transaction has changed. Attribute: ID of the transaction in question
Response To Notification
Reception of request is confirmed by HTTP/200 OK status code, with body consisting of two bytes OK.

Any other reply will be treated as error, and request will be repeated.

Example Notification

  https://shop_url.com/?cmd=transactionStatusChanged&args=asd34sf&sign=c8143d45bf2f76fd38a6a9d77feb1a79


Custom notification URL for each shop can be settled in CashBill Control Panel.

Available Transaction Statuses
Status	Description
PreStart	Payment has been started. Customer has not yet choosen payment channel.
Start	Payment has been started. Customer has not yet paid.
NegativeAuthorization	Payment Channel has refused payment (ie. insufficient funds).
Abort	Customer has aborted the payment.
Fraud	Payment Channel has refused payment and classified is as fraudant. This is a final status and cannot change.
PositiveAuthorization	Payment Channel has accepted transaction for processing.
PositiveFinish	Payment Channel has confirmed transfer of funds. This is a final status and cannot change.
NegativeFinish	Payment Channel has refused transfer of funds. This is a final status and cannot change.

POST
https://pay.cashbill.pl/ws/rest/payment/:shopId
You can put information about landing page for exist transaction.

Generate digital signature using:

SHA1(title + amount.value + amount.currencyCode + returnUrl + description + negativeReturnUrl + additionalData + paymentChannel + languageCode + referer + personalData.firstName + personalData.surname + personalData.email + personalData.country + personalData.city + personalData.postcode + personalData.street + personalData.house + personalData.flat + personalData.ip + optionsKeyValueList + secretKey)


optionsKeyValueList is combination of key and value pair

optionsKeyValueList = key1 + value1 + ... + keyN + valueN

Request
Path Parameters

shopId
string
required
Payment Point ID

application/json
application/x-www-form-urlencoded
Body

title
string
required
Possible values: non-empty

Title of the transaction

amount

object

description
string
Description of the transaction

additionalData
string
Additional transaction data, hidden from customer

returnUrl
string
URL of landing page after successful transaction

negativeReturnUrl
string
URL of landing page after unsuccessfull transaction. If ommited, customer will be redirected to returnUrl

paymentChannel
string
ID of payment channel obtained from GET paymentchannels, request. If ommited, customer will be prompted with default CashBill payment channel selection screen.

languageCode
string
Language code. Available: PL, EN

personalData

object

referer
string
Shopping platform identifier

options

object[]

sign
string
required
Possible values: non-empty

Digital signature

Responses
200
OK

application/json
Schema
Example (from schema)
Schema

id
string
Payment Id

redirectUrl
string
The address to which the browser should redirect customer to start payment

additional

object

curl
python
go
nodejs
ruby
csharp
php
java
powershell
AXIOS
NATIVE
const axios = require('axios');
let data = JSON.stringify({
  "title": "string",
  "amount": {
    "value": 0,
    "currencyCode": "string"
  },
  "description": "string",
  "additionalData": "string",
  "returnUrl": "string",
  "negativeReturnUrl": "string",
  "paymentChannel": "string",
  "languageCode": "string",
  "personalData": {
    "firstName": "string",
    "surname": "string",
    "email": "string",
    "country": "string",
    "city": "string",
    "postcode": "string",
    "street": "string",
    "house": "string",
    "flat": "string",
    "ip": "string"
  },
  "referer": "string",
  "options": [
    {
      "name": "string",
      "value": "string"
    }
  ],
  "sign": "string"
});

let config = {
  method: 'post',
maxBodyLength: Infinity,
  url: 'https://pay.cashbill.pl/ws/rest/payment/:shopId',
  headers: { 
    'Content-Type': 'application/json', 
    'Accept': 'application/json'
  },
  data : data
};

axios(config)
.then((response) => {
  console.log(JSON.stringify(response.data));
})
.catch((error) => {
  console.log(error);
});


Request
Collapse all
Base URL
https://pay.cashbill.pl/ws/rest
Parameters
shopId — pathrequired
Payment Point ID
Body
Content-Type

application/json
{
  "title": "string",
  "amount": {
    "value": 0,
    "currencyCode": "string"
  },
  "description": "string",
  "additionalData": "string",
  "returnUrl": "string",
  "negativeReturnUrl": "string",
  "paymentChannel": "string",
  "languageCode": "string",
  "personalData": {
    "firstName": "string",
    "surname": "string",
    "email": "string",
    "country": "string",
    "city": "string",
    "postcode": "string",
    "street": "string",
    "house": "string",
    "flat": "string",
    "ip": "string"
  },
  "referer": "string",
  "options": [
    {
      "name": "string",
      "value": "string"
    }
  ],
  "sign": "string"
}
Previous
Introduction
Next
Requesting details of transaction

Payment Gateway APIPayment ResourceRequesting details of transaction
Requesting details of transaction

GET
https://pay.cashbill.pl/ws/rest/payment/:shopId/:orderId
You can request detailed information about transaction.

Generate digital signature using:

SHA1(orderId + secretKey)

Request
Path Parameters

orderId
string
required
Order ID

shopId
string
required
Payment Point ID

Query Parameters

sign
string
required
Possible values: non-empty

Digital signarute

Responses
200
OK

application/json
Schema
Example (from schema)
Schema

id
string
paymentChannel
string
amount

object

requestedAmount

object

title
string
description
string
personalData

object

additionalData
string
status
string
details

object

curl
python
go
nodejs
ruby
csharp
php
java
powershell
AXIOS
NATIVE
const axios = require('axios');

let config = {
  method: 'get',
maxBodyLength: Infinity,
  url: 'https://pay.cashbill.pl/ws/rest/payment/:shopId/:orderId',
  headers: { 
    'Accept': 'application/json'
  }
};

axios(config)
.then((response) => {
  console.log(JSON.stringify(response.data));
})
.catch((error) => {
  console.log(error);
});


Request
Collapse all
Base URL
https://pay.cashbill.pl/ws/rest
Parameters
orderId — pathrequired
Order ID
shopId — pathrequired
Payment Point ID
sign — queryrequired
Digital signarute
Previous
Creating new transaction
Next
Putting landing page URL for exist transaction

Payment Gateway APIPayment ResourcePutting landing page URL for exist transaction
Putting landing page URL for exist transaction

PUT
https://pay.cashbill.pl/ws/rest/payment/:shopId/:orderId
You can put information about landing page for exist transaction.

Generate digital signature using:

SHA1(orderId + returnUrl + negativeReturnUrl + secretKey)

Request
Path Parameters

orderId
string
required
Order ID

shopId
string
required
Payment Point ID

application/json
application/x-www-form-urlencoded
Body

returnUrl
string
required
Possible values: non-empty

URL of landing page after successful transaction

negativeReturnUrl
string
URL of landing page after unsuccessfull transaction. If ommited, customer will be redirected to returnUrl

sign
string
required
Possible values: non-empty

Digital signature

Responses
204
No Content

curl
python
go
nodejs
ruby
csharp
php
java
powershell
AXIOS
NATIVE
const axios = require('axios');
let data = JSON.stringify({
  "returnUrl": "string",
  "negativeReturnUrl": "string",
  "sign": "string"
});

let config = {
  method: 'put',
maxBodyLength: Infinity,
  url: 'https://pay.cashbill.pl/ws/rest/payment/:shopId/:orderId',
  headers: { 
    'Content-Type': 'application/json'
  },
  data : data
};

axios(config)
.then((response) => {
  console.log(JSON.stringify(response.data));
})
.catch((error) => {
  console.log(error);
});


Request
Collapse all
Base URL
https://pay.cashbill.pl/ws/rest
Parameters
orderId — pathrequired
Order ID
shopId — pathrequired
Payment Point ID
Body
Content-Type

application/json
{
  "returnUrl": "string",
  "negativeReturnUrl": "string",
  "sign": "string"
}
Previous
Requesting details of transaction
Next
Requesting available payment channels


Payment Gateway APIPayment Channels ResourceRequesting available payment channels
Requesting available payment channels

GET
https://pay.cashbill.pl/ws/rest/paymentchannels/:shopId/:languageCode
You can obtain list of available payment channels from paymentchannels resource.

Request
Path Parameters

languageCode
string
Possible values: Value must match regular expression (([a-zA-Z]{2})?)

Default value: PL

Language code (PL, EN)

shopId
string
required
Payment Point ID

Responses
200
OK

application/json
Schema
Example (from schema)
Schema

Array [

id
string
Payment Channel ID

availableCurrencies
string[]
List of available currencies

name
string
Name

description
string
Description

logoUrl
string
URL of image

]

curl
python
go
nodejs
ruby
csharp
php
java
powershell
AXIOS
NATIVE
const axios = require('axios');

let config = {
  method: 'get',
maxBodyLength: Infinity,
  url: 'https://pay.cashbill.pl/ws/rest/paymentchannels/:shopId/:languageCode',
  headers: { 
    'Accept': 'application/json'
  }
};

axios(config)
.then((response) => {
  console.log(JSON.stringify(response.data));
})
.catch((error) => {
  console.log(error);
});


Request
Collapse all
Base URL
https://pay.cashbill.pl/ws/rest
Parameters
shopId — pathrequired
Payment Point ID


API
GitHub

Payment Gateway API

Introduction
Payment Resource
Creating new transaction
Requesting details of transaction
Putting landing page URL for exist transaction
Payment Channels Resource
Requesting available payment channels
Usage Examples
Get a list of available payment channels
Start transaction
Change landing page for an existing transaction
Get payment details
Payment Gateway APIUsage ExamplesGet a list of available payment channels
Get a list of available payment channels
Example request
PHP
<?php

$shopId = ""; // Payment Point ID
$secretPhrase = ""; // Payment Point Secret
$mainUrl = "https://pay.cashbill.pl/ws/rest";
$ch = curl_init();


curl_setopt_array($ch, array(
    CURLOPT_RETURNTRANSFER => true,
    CURLOPT_URL => "{$mainUrl}/paymentchannels/{$shopId}",
));

$paymentChannels = json_decode(curl_exec($ch));


Schema of the response
[
  {
    "id": "string",
    "availableCurrencies": [
      "string"
    ],
    "name": "string",
    "description": "string",
    "logoUrl": "string"
  }
]


Payment Gateway APIUsage ExamplesStart transaction
Start transaction
Example request
PHP
<?php

$shopId = ""; // Payment Point ID
$secretPhrase = ""; // Payment Point Secret
$mainUrl = "https://pay.cashbill.pl/ws/rest";
$ch = curl_init();


$transactionRequest = array(
    "title" => "Example #1",
    "amount" => array(
        "value" => 1.23,
        "currencyCode" => "PLN",
    ),
    "returnUrl" => "https://cashbill.pl",
    "description" => "Transaction description example",
    "additionalData" => "#1",
);


$transactionRequest['sign'] = sha1($transactionRequest['title']
    . $transactionRequest['amount']['value'] . $transactionRequest['amount']['currencyCode']
    . $transactionRequest['returnUrl'] . $transactionRequest['description'] . $transactionRequest['additionalData']
    . $secretPhrase);


curl_setopt_array($ch, array(
    CURLOPT_RETURNTRANSFER => true,
    CURLOPT_CUSTOMREQUEST => "POST",
    CURLOPT_URL => "{$mainUrl}/payment/{$shopId}",
    CURLOPT_HTTPHEADER =>  array("Content-Type: application/json"),
    CURLOPT_POSTFIELDS => json_encode($transactionRequest)
));

$ret = curl_exec($ch);
$response = json_decode($ret);

if (curl_getinfo($ch, CURLINFO_HTTP_CODE) != "200") {
    echo "Error message: {$response->errorMessage}";
} else {
    echo "Order ID [{$response->id}] and redirect URL [{$response->redirectUrl}]";
}

Schema of the response
{
  "id": "string",
  "redirectUrl": "string"
} 


Payment Gateway APIUsage ExamplesChange landing page for an existing transaction
Change landing page for an existing transaction
Example request
PHP
<?php

$shopId = ""; // Payment Point ID
$secretPhrase = ""; // Payment Point Secret
$orderId = ""; // Order ID
$mainUrl = "https://pay.cashbill.pl/ws/rest";
$ch = curl_init();


$modifyRequest = array(
    "returnUrl" => "https://cashbill.pl/ok",
    "negativeReturnUrl" => "https://cashbill.pl/err",
);

$modifyRequest['sign'] = sha1($orderId . $modifyRequest['returnUrl'] . $modifyRequest['negativeReturnUrl'] . $secretPhrase);

curl_setopt_array($ch, array(
    CURLOPT_RETURNTRANSFER => true,
    CURLOPT_CUSTOMREQUEST => "PUT",
    CURLOPT_URL => "{$mainUrl}/payment/{$shopId}/{$orderId}",
    CURLOPT_HTTPHEADER =>  array("Content-Type: application/json"),
    CURLOPT_POSTFIELDS => json_encode($modifyRequest)
));

$ret = curl_exec($ch);
$response = json_decode($ret);

if (curl_getinfo($ch, CURLINFO_HTTP_CODE) != "204") {
    echo "Error message: {$response->errorMessage}";
} else {
    echo "Done";
}

Payment Gateway APIUsage ExamplesGet payment details
Get payment details
Example request
PHP
<?php

$shopId = ""; // Payment Point ID
$secretPhrase = ""; // Payment Point Secret
$orderId = ""; // Order ID
$mainUrl = "https://pay.cashbill.pl/ws/rest";
$ch = curl_init();

$sign = sha1($orderId . $secretPhrase);


curl_setopt_array($ch, array(
    CURLOPT_RETURNTRANSFER => true,
    CURLOPT_CUSTOMREQUEST => "GET",
    CURLOPT_URL => "{$mainUrl}/payment/{$shopId}/{$orderId}?sign={$sign}",
));

$ret = curl_exec($ch);
$response = json_decode($ret);

if (curl_getinfo($ch, CURLINFO_HTTP_CODE) != "200") {
    echo "Error message: {$response->errorMessage}";
} else {
    echo "Order Id [{$response->id}] with status [{$response->status}]";
}

Schema of the response
{
  "id": "string",
  "paymentChannel": "string",
  "amount": {
    "value": 0,
    "currencyCode": "string"
  },
  "requestedAmount": {
    "value": 0,
    "currencyCode": "string"
  },
  "title": "string",
  "description": "string",
  "personalData": {
    "firstName": "string",
    "surname": "string",
    "email": "string",
    "country": "string",
    "city": "string",
    "postcode": "string",
    "street": "string",
    "house": "string",
    "flat": "string",
    "ip": "string"
  },
  "additionalData": "string",
  "status": "string"
}